(function(e){e.fn.extend({addRow:function(t){var n={addClass:false,rowHtml:false,dropClass:".drop-row",clickToAdd:".add-row",callback:function(){}};var t=e.extend(n,t);t.rowHtml="<tr>"+e("tbody").children().last("tr").html()+"</tr>";triggerCallback=function(){if(typeof t.callback=="function"){t.callback.call(this)}};addNewRow=function(){addRowHtml=t.rowHtml+"\n";if(t.addClass===false){if(e("tbody").append(addRowHtml)){return triggerCallback()}}else{if(e(e("tbody").children().last(t.addClass)).after(addRowHtml)){return triggerCallback()}}};toggleDropRowLink=function(n){if(e(t.dropClass).length<n+1){e(t.dropClass).hide()}else{e(t.dropClass).show()}};dropRow=function(){e(t.dropClass).on("click",function(){e(this).parents("tr").first().remove();toggleDropLink()})};dropLinkCount=function(){return e(t.dropClass).length};toggleDropLink=function(){if(dropLinkCount()<2){e(t.dropClass).css({display:"none"})}else{e(t.dropClass).css({display:"block"})}};if(t.rowHtml===false){if(t.addClass===false){t.rowHtml=e("tbody").children().last("tr").html()}else{t.rowHtml=e(t.addClass).html()}}e(t.clickToAdd).on("click",function(){addNewRow();dropRow();toggleDropLink()})}})})(jQuery)
